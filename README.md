# python-nexus-utilities
Functions to assist with building example NeXus files in the proposed format for ESS from existing NeXus files and Mantid IDFs.

Tested with Python 3.5. You can install dependencies with
```
pip install -r requirements.txt
```

To display the plots generated by `DetectorPlotter` you may need to install tk libraries, on Ubuntu for example:
```
sudo apt install python3-tk
```

## Examples

Examples can be found in the `example_instruments` directory. Example scripts should be run from their own directory with the root directory of the repository in `PYTHONPATH` (IDEs such as PyCharm do this by default).

- `SANS2D_example.py` - example using a NeXus file and Mantid instrument definition from the SANS2D instrument. This outputs a new NeXus file in the proposed new format and contains examples of using the proposed `NXsolid_geometry` group to describe pixel shape.

- `WISH_example` - geometry example using a Mantid IDF for the WISH instrument. This demonstrates conversion from a polar coordinates system and more complex geometry with many (10 panels x 152 tubes x 512 pixels) detector pixels.

- `LOKI_example.py` - geometry example using a Mantid IDF for the LOKI instrument. It contains an example of using an `NXsolid_geometry` group to describe the shape of entire detector panels. 

- `SANS2D_NXlog_example.py` - demonstrates how one can use the new `NXevent_data` group and changes to `NXlog` to extract data for a specific time period from the file.

## Tests

Unit tests require pytest (`pip install pytest`) can be run with
```
pytest
```

An html test coverage report can be generated using pytest-cov (`pip  install pytest-cov`): 
```
pytest --cov-config .coveragerc --cov-report html --cov=. tests/
```
